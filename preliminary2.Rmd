---
title: "Preliminary Findings Volume Two"
mainfont: Times New Roman
author: "Kaan Aksoy"
date: "2 April 2023"
header-includes:
  - \usepackage{setspace}\doublespacing
  - \usepackage{booktabs}
output: 
  pdf_document: 
    latex_engine: xelatex
    extra_dependencies: float
    fig_caption: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, include = FALSE, message = FALSE, warning = FALSE)
```
```{r Libraries}
# Load libraries ----
library(tidyverse)
library(haven)
library(estimatr)     # To cluster standard errors
library(modelsummary) # For neat reporting tables
library(kableExtra)   # For additional table formatting
```
```{r Data loading and preparation}
# Load data ----
mydata1 <- read_csv("~/Documents/Data/V_Dem_v12.csv") %>% 
  filter(., v2x_polyarchy <= 0.42) # To filter out the non-democracies.

# Write a function to reverse the scales of some unintuitively coded variables.
reversr <- function (x, na.rm = T) {
  min(x, na.rm = T) - x + max(x, na.rm = T)
}

mydata2 <- read_delim("~/Documents/Data/GurievTreisman2019Data/Replication/masskillings.txt") %>% 
  mutate(., masskilling = as_factor(lag(ongoing, n = 3)),
         country_name = country,
         country_text_id = sftgcode) %>% 
  select(., c("country_text_id", "year", "masskilling")) %>% 
  na.omit(.)

df1 <- list(mydata1, mydata2) %>% 
  reduce(left_join, by = c("country_text_id", "year"))
```
```{r First six models, include=TRUE}
lm1 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy),
                 data = mydata1,
                 clusters = country_id)

lm2 <- lm_robust(reversr(v2excrptps) ~ v2exl_legitperf,
                 data = mydata1,
                 clusters = country_id)

lm3 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf,
                 data = mydata1,
                 clusters = country_id)

lm4 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf +
                   log(e_gdppc),
                 data = mydata1,
                 clusters = country_id)

lm5 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf +
                   log(e_gdppc) + v2x_polyarchy,
                 data = mydata1,
                 clusters = country_id)

lm6 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf +
                   log(e_gdppc) + v2x_polyarchy + masskilling,
                 data = df1,
                 clusters = country_id)
# Report them ----
modelsummary(list(lm1, lm2, lm3, lm4, lm5, lm6),
             output = 'kableExtra',
             stars = c('*' = .1, '**' = .05, '***' = .01),
             coef_map = c('reversr(v2x_clphy)' = 'Physical violence index',
                          'v2exl_legitperf' = 'Performance legitimation',
                          'log(e_gdppc)' = 'Logged GDP per capita',
                          'v2x_polyarchy' = 'Electoral democracy index',
                          'masskilling1' = 'Mass killing (3 years)',
                          '(Intercept)' = 'Intercept'),
             gof_omit = 'BIC|Log.Lik.|RMSE|Std.Errors',
             notes = list('Standard errors clustered by country.')) %>%
  add_header_above(c(" " = 1,
                     "Low-level bribery" = 6)) %>% 
  kable_styling(latex_options = "HOLD_position")
```
These models are largely what I have done before, though I have filtered to autocratic countries (i.e., a V-Dem polyarchy index of 0.42 and lower) instead of taking only the most autocratic 20% of the sample. In addiiton, I've included a lagged variable in the final model, where the variable is coded "1" if there has been a mass killing in the country in the last three years, and "0" if not.

As you can see from the results, adding that variable in increases the standard errors and makes everything statistically insignificant, but I blame that---at least partially---on the severely reduced sample size (the data by Treisman and Guriev is limited).

I've also made a boxplot to see if there is any notable difference between the two "types" of countries, below.
```{r Boxplot, include=TRUE}
df1 %>% 
  select(., c("v2excrptps", "masskilling")) %>% 
  na.omit(.) %>% 
  ggplot(.,
         aes(x = masskilling,
             y = reversr(v2excrptps))) +
  geom_boxplot() +
  scale_x_discrete(breaks = c("1", "0"),
                   labels = c("Yes", "No")) +
  labs(title = "Low-level corruption in mass killing autocracies and\nnon-mass killing autocracies",
       x = "Mass killing within last three years?",
       y = "Low-level corruption") +
  theme_linedraw()
```
```{r DPI data, include=TRUE}
# Load the DPI data ----
mydata3 <- read_dta("~/Documents/Data/DPI2015/DPI2015.dta") %>% 
  naniar::replace_with_na(replace = list(liec = c(-999),
                                         eiec = c(-999))) %>% 
  filter(., liec <= 5 & # Non-democracies. Can also be tried with "7" for dominant parties.
           ifs != 0) %>%  
  mutate(., country_text_id = ifs) %>% 
  select(., c("country_text_id", "year", "liec", "eiec"))

df2 <- list(mydata3, df1) %>% 
  reduce(left_join, by = c("country_text_id", "year"))

# Now try it with the DPI data.

lm7 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy),
                 data = df2,
                 clusters = country_id)

lm8 <- lm_robust(reversr(v2excrptps) ~ v2exl_legitperf,
                 data = df2,
                 clusters = country_id)

lm9 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf,
                 data = df2,
                 clusters = country_id)

lm10 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf +
                   log(e_gdppc),
                 data = df2,
                 clusters = country_id)

lm11 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf +
                   log(e_gdppc) + liec,
                 data = df2,
                 clusters = country_id)

lm12 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf +
                    log(e_gdppc) + liec + eiec,
                  data = df2,
                  clusters = country_id)

lm13 <- lm_robust(reversr(v2excrptps) ~ reversr(v2x_clphy) + v2exl_legitperf +
                    log(e_gdppc) + liec + eiec + masskilling,
                  data = df2,
                  clusters = country_id)

modelsummary(list(lm7, lm8, lm9, lm10, lm11, lm12, lm13),
             output = 'kableExtra',
             stars = c('*' = .1, '**' = .05, '***' = .01),
             coef_map = c('reversr(v2x_clphy)' = 'Physical violence index',
                          'v2exl_legitperf' = 'Performance legitimation',
                          'log(e_gdppc)' = 'Logged GDP per capita',
                          'liec' = 'Legislative electoral competitiveness',
                          'eiec' = 'Executive electoral competitiveness',
                          'masskilling1' = 'Mass killing',
                          '(Intercept)' = 'Intercept'),
             gof_omit = 'BIC|Log.Lik.|RMSE|Std.Errors',
             notes = list('Standard errors clustered by country.')) %>% 
  add_header_above(c(" " = 1,
                   "Low-level bribery" = 7)) %>% 
  kable_styling(latex_options = "HOLD_position")
```
I've used data from the Database of Political Institutions here. Unfortunately, as they do not have a variable for corruption *or* political repression, the main dependent and independent variables are still from the V-Dem data. However, here I've used their measures of democracy. They have two indices, the "legislative index of electoral competitiveness" and "executive index of electoral competitiveness". I've utilised the former to select autocracies, and have not included multi-party states which are dominant party systems in the sample.

While the significance levels are not at the 99% level, probably due to sample size, the directionality of the effect remains the same.

Finally, I've tried something else suggested by Dr. Sugiyama: she suggested that the time it takes to open a business may be an interesting proxy measure by which we can measure corruption (and for what it's worth, I think it does make sense for high levels of low-level corruption to make the process take longer).
```{r Business days, include=TRUE}
mydata4 <- read_csv("~/Documents/Data/businessopen.csv", skip = 3) %>% 
  mutate(., country_text_id = `Country Code`,
         country_name = `Country Name`) %>% 
  select(., -c("Indicator Name", "Indicator Code", "Country Name", "Country Code")) %>% 
  pivot_longer(cols = 1:63,
               names_to = "year",
               values_to = "businessdays") %>% 
  mutate(., year = as.numeric(year)) %>% 
  filter(., country_text_id %in% df1$country_text_id) %>% 
  na.omit()

df3 <- list(mydata4, df1) %>% 
  reduce(left_join, by = c("country_text_id", "year"))

# More models with this new dependent variable.

lm14 <- lm_robust(businessdays ~ reversr(v2x_clphy),
                 data = df3,
                 clusters = country_id)

lm15 <- lm_robust(businessdays ~ v2exl_legitperf,
                 data = df3,
                 clusters = country_id)

lm16 <- lm_robust(businessdays ~ reversr(v2x_clphy) + v2exl_legitperf,
                 data = df3,
                 clusters = country_id)

lm17 <- lm_robust(businessdays ~ reversr(v2x_clphy) + v2exl_legitperf +
                   log(e_gdppc),
                 data = df3,
                 clusters = country_id)

lm18 <- lm_robust(businessdays ~ reversr(v2x_clphy) + v2exl_legitperf +
                   log(e_gdppc) + v2x_polyarchy,
                 data = df3,
                 clusters = country_id)

modelsummary(list(lm14, lm15, lm16, lm17, lm18),
             output = 'kableExtra',
             stars = c('*' = .1, '**' = .05, '***' = .01),
             coef_map = c('reversr(v2x_clphy)' = 'Physical violence index',
                          'v2exl_legitperf' = 'Performance legitimation',
                          'log(e_gdppc)' = 'Logged GDP per capita',
                          'v2x_polyarchy' = 'Electoral democracy index',
                          '(Intercept)' = 'Intercept'),
             gof_omit = 'BIC|Log.Lik.|RMSE|Std.Errors',
             notes = list('Standard errors clustered by country.')) %>% 
  add_header_above(c(" " = 1,
                     "Time taken to open business (days)" = 5)) %>% 
  kable_styling(latex_options = "HOLD_position")
```
Regrettably, the World Bank data used here offers less data points than I would have liked. However, the initial theory is supported nonetheless in the first model and the third model: higher levels of physical violence lead to more days to open a business.